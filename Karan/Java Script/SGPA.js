const departments = {
    CSE: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],



        3: [
            ["Mathematics III", 4],
            ["Digital Electronics", 3],
            ["Object Oriented Programming", 3],
            ["Computer Networks", 3],
            ["Human Values and proffesional Ethics ", 3],
            ["Object Oriented Programming Lab", 2],
            ["Digital Electronics Lab", 1], 
            ["Computer Networks Lab", 1],
            ["Training-I(TR-101) ", 1],
            ["Seminar and Technical Report", 1]
        ],

        4: [
            ["Discrete Mathematics", 4],
            ["Computer Architecture and Microprocessor", 3],
            ["Operating System", 4],
            ["Software Engineering", 4],
            ["Data Structures", 3],
            ["Computer Architecture and Microprocessor LAB", 1],
            ["Operating System LAB", 1],
            ["Data Structures Lab", 2],
            ["Environment Science", 0],
            ["Mentoring and Professional Development", 1]
        ],
        5: [
            ["Artificial Intelligence", 3], 
            ["Database Management Systems ", 3],
            ["Formal Language and Automata Theory", 4],
            ["Design and analysis of Algorithm", 4],
            ["Elective-I", 3],
            ["Artificial Intelligence Lab", 1],
            ["Database Management Systems Lab", 1],
            ["Design and Analysis of Algorithms Lab", 1],
            ["Constitution of India/Organizational Behaviour", 0],
            ["Training-II(TR-102)", 1]
        ],
        6: [
            ["Compiler Design", 4],
            ["Computer Graphics", 4],
            ["Machine Learning", 3],
            ["Cyber Securitys", 3],
            ["Elective-II", 3],
            ["Open Elective-I", 3],
            ["Computer Graphics Lab", 1],
            ["Machine Learning Lab", 1],
            ["Elective-II Lab", 1],
            ["Minor Project", 1],
            ["Mentoring and Professional Development", 1],
        ],

        // 7: [
        //     ["Elective-III", 4],
        //     ["Elective-IV", 3],
        //     ["Elective-III Lab", 1],
        //     ["Open Elective-II", 3],
        //     ["Major Project", 3],
        //     ["Technical Aptitude",1],
        //     [" Training -III(TR-103)", 1]
        // ],
        
       

    },



    IT: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

        3: [
            ["Data Structures", 3],
            ["OOPs using C++", 3],
            ["Digital Circuits and Logic Design", 3],
            ["Data Communication and Computer Networks", 3],
            ["Proffessional Ethics for IT Engineers ", 3],
            ["Data Structures Lab", 2],
            ["OOPs using C++ Lab", 1], 
            ["DCCN Lab", 1],
            ["DCLD Lab", 1],
            ["Training-I(TR-101) ", 1],
            ["Environment Sciences", 0],
            ["Seminar and Technical Report Writing",1]
        ],

        4: [
            ["Probability and Statistics", 3],
            ["Database Management System", 3],
            ["Python Programming", 3],
            ["Operating System", 3],
            ["Web Technologies", 3],
            ["Computer Architecture and Microprocessor", 3],
            ["DBMS LAB", 1],
            ["Python Lab", 1],
            ["OSM LAB", 1],
            ["WT Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],
        5: [
            ["Programming in Java", 4], 
            ["Java Lab ", 2],
            ["Discrete Math", 4],
            ["Internet of Things", 3],
            ["IOT Lab", 1],
            ["Theory of Computation", 4],
            ["P-Elective-I", 3],
            ["P-Elective-I Lab", 1],
            ["Training-II(TR-102)", 1]
        ],
        6: [
            ["Design and Analysis of Algorithms", 4],
            ["DAA Lab", 1],
            ["Machine Learning", 4],
            ["ML Lab", 1],
            ["Software Architecture ", 4],
            ["SA Lab",1],
            ["P-Elective-II", 3],
            ["P-Elective-II Lab", 1],
            ["Open Elective", 3],
            ["Minor Project", 1],
            ["Mentoring and Professional Development", 1],
        ],

        
       

    },


    ME: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

        3: [
            ["Engineering Mechanics", 3],
            ["Thermodynamics", 3],
            ["Strength of Materials", 4],
            ["Manufacturing Processes ", 3],
            ["Machine Drawing and Computer Aided Design ", 3],
            ["Engineering Materials and Metallurgy", 3],
            ["Strength of Materials Lab", 1], 
            ["Engineering Materials and Metallurgy Lab", 1],
            ["Training-I(TR-101) ", 1],
            ["Manufacturing Processes Lab", 1]
        ],

        4: [
            ["Theory of Machines", 4],
            ["Applied Thermodynamics", 4],
            ["Mathematics III", 3],
            ["Fluid Mechanics and Machinery", 4],
            ["Modern Manufacturing Processes", 3],
            ["Theory of Machines Laboratory", 1],
            ["Applied Thermodynamics Lab", 1],
            ["Fluid Mechanics and Machinery Lab", 1],
            ["Modern Manufacturing Processes Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],
        5: [
            ["Finite Element Method", 2], 
            ["Design of Machine Elements ", 4],
            ["Heat Transfer ", 4],
            ["Operation Research", 3],
            ["Mechanical Measurement and Control", 3],
            ["Industrial Automation and Robotics", 3],
            ["Industrial Automation and Robotics Lab", 1],
            ["Mechanical Measurement and Control  Lab", 1],
            ["Heat Transfer Laboratory", 1],
            ["Training-II(TR-102)", 1]
        ],
        6: [
            ["Mechanical Vibrations", 3],
            ["Refrigeration and Air Conditioning", 4],
            ["Elective - I", 4],
            ["Elective - II", 4],
            ["Open Elective-I", 3],
            ["Mechanical Vibrations Lab", 1],
            ["Refrigeration and Air Conditioning Lab", 1],
            ["Minor Project", 1],
            ["Seminar", 1],
            ["Mentoring and Professional Development", 1],
            ["Open Elective", 0]
        ],

    },


    CE: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

        3: [
            ["Surveying & Geomatics", 4],
            ["Solid Mechanics", 3],
            ["Fluid Mechanics", 3],
            ["Disaster Preparedness & Planning ", 3],
            ["Basic Electronics & applications in Civil Engineering ", 3],
            ["Civil Engineering Introduction, Societal & Global Impact", 3],
            ["Surveying & Geomatics  Lab", 1], 
            ["Fluid Mechanics  Lab", 1],
            ["Solid Mechanics  Lab", 1],
            ["Training-I(TR-101) ", 1]
            
        ],

        4: [
            ["Concrete Technology", 3],
            ["Material, Testing & Evaluation", 4],
            ["Hydrology & Water Resources Engineering", 4],
            ["Transportation Engineering", 4],
            ["Mathematics-III ", 3],
            ["Concrete Testing Laboratory", 1],
            ["Transportation Lab", 1],
            ["Seminar and Technical Report Writing", 1],
            ["Environment Science", 0],
            ["Mentoring and Professional Development", 1]
        ],
        5: [
            ["Engineering Geology ", 3], 
            ["Engineering Economics, Estimation and Costing ", 4],
            ["Construction Engineering & Management", 3],
            ["Environmental Engineering ", 4],
            ["Structural Engineering", 4],
            ["Geotechnical Engineering  ", 3],
            ["Geotechnical Lab", 1],
            ["Environmental Engineering  Lab", 1],
            ["Structural  Laboratory", 1],
            ["Training-II(TR-102)", 1]
        ],
        6: [
            ["Irrigation Engineering", 4],
            ["Building Construction Practice", 3],
            ["Track Specific Course - I ", 4],
            ["Track Specific Course - II ", 4],
            ["Open Elective-I", 3],
            ["CAD & BIM Lab", 1],
            ["Constitution of India/ Management -I (Organizational Behaviour)", 0],
            ["Minor Project", 1],
            ["Mentoring and Professional Development", 1]
          
        ],

    },




    ECE: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

       3: [
            ["Mathematics - III ", 3],
            ["Electronics Devices ", 3],
            ["Signals and Systems", 4],
            ["Digital Electronics ", 4],
            ["Network Analysis ", 4],
            ["Computer Architecture", 3],
            ["Environmental Science", 0], 
            ["Electronics Device Lab", 1],
            ["Digital Device Lab", 1],
            ["Training-I(TR-101) ", 1]
            
        ],

        4: [
            ["Analog Circuits", 4],
            ["OOPs", 3],
            ["Electromagnetic Feild ", 3],
            ["Linear Control Systems", 4],
            ["Information Management", 3],
            ["Analog Circuits Lab", 1],
            ["Measuement control Lab", 1],
            ["OOPs Lab", 1],
            ["Seminar and Technical Report Writing", 1],
            ["Intelligent signal processing lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

    

        5: [
            ["Analog and Communication System ", 3], 
            ["Digital Signal Processing ", 4],
            ["Microprocessors & Micocontrollers", 4],
            ["Antenna and wave propogation", 3],
            ["Computer Networks", 3],
            ["constitution of India", 0],
            ["Analog Communication system Lab", 1],
            ["Digital signal processing Lab", 1],
            ["Microprocessor and Microcontroller Lab", 1],
            ["Computer Network Lab", 1],
            ["Training-II(TR-102)", 1]
            
        ],
        6: [
            ["Digital communication systems", 3],
            ["Microwave and Radar Engineering", 3],
            ["Elective-I ", 4],
            ["Elective-II ", 4],
            ["Digital communication system Lab", 1],
            ["Microwave and Radar Engineering Lab", 1],
            ["Minor Project", 1],
            ["Mentoring and Professional Development", 1]
          
        ],

    },


    EE: {
        1: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1]
        ],

        11: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
           
        ],



        2: [
            ["Mathematics I", 4],
            ["Physics", 4],
            ["Principles of Engineering Economics and Management", 3],
            ["Basic Electrical Engineering", 4],
            ["Engineering Graphics and Design", 3],
            ["Physics LAB", 1],
            ["BasicElectrical Engineering LAB", 1],
            ["Mentoring and Professional Development", 1]
        ],

        22: [
            ["Mathematics II", 4],
            ["Chemistry", 4],
            ["Programming for Problem Solving", 4],
            ["English", 3],
            ["Manufacturing Practices", 2],
            ["Chemistry Lab", 1],
            ["Programming for Problem Solving Lab", 1],
            ["English Lab", 1],
            ["Mentoring and Professional Development", 1]
        ],

        3: [
            ["Mathematics-III", 3],
            ["Education, Technology and Society ", 3],
            ["Electrical Circuit Analysis", 4],
            ["Analog Electronics ", 4],
            ["Electrical Machines-I ", 4],
            ["Electromagnetic Fields", 3],
            ["Analog Electronics  Lab", 1], 
            ["Electrical Machines   Lab", 1],
            ["Training-I(TR-101) ", 1]
            
        ],

        4: [
            ["Digital Electronics", 4],
            ["Electrical Machines-II", 4],
            ["Power Electronics ", 4],
            ["Signals and Systems", 4],
            ["Digital Electronics Lab", 1],
            ["Electrical Machines-II Lab", 1],
            ["Power Electronics Lab", 1],
            ["Seminar and Technical Report Writing", 1],
            ["Environment Science", 0],
            ["Mentoring and Professional Development", 1]
        ],
        5: [
            ["Power Systems-I ", 4], 
            ["Control Systems ", 4],
            ["Microprocessors & Micocontrollers", 4],
            ["Measurements and Instrumentation ", 4],
            ["Electric Generation and Economics", 4],
            ["Power Systems-I Lab", 1],
            ["Control and Instrumentation Lab", 1],
            ["Microprocessors & Microcontrollers Laboratory", 1],
            ["Training-II(TR-102)", 1],
            ["Open-Elective ", 0]
        ],
        6: [
            ["Power Systems - II ", 4],
            ["PLC and Industrial Drives", 3],
            ["Elective-I ", 4],
            ["Elective-II ", 4],
            ["Open Elective-I", 3],
            ["Power Systems Lab", 1],
            ["PLC and Automation Lab", 1],
            ["Industrial Drives Laboratory",1]
            ["Minor Project", 1],
            ["Mentoring and Professional Development", 1]
          
        ],

    },
    
};

document.getElementById('department').addEventListener('change', loadSubjects);
document.getElementById('semester').addEventListener('change', loadSubjects);

function loadSubjects() {
    const department = document.getElementById('department').value;
    const semester = document.getElementById('semester').value;
    const subjectsDiv = document.getElementById('subjects');
    subjectsDiv.innerHTML = '';

    const subjects = departments[department] ? departments[department][semester] : [];
    subjects.forEach((subject, index) => {
        const subjectDiv = document.createElement('div');
        subjectDiv.classList.add('subject');

        const subjectName = document.createElement('span');
        subjectName.textContent = `${subject[0]} (Credits: ${subject[1]})`;
        subjectDiv.appendChild(subjectName);

        const internalMarks = document.createElement('input');
        internalMarks.type = 'number';
        internalMarks.max = '40';
        internalMarks.placeholder = 'Internal Marks (min 16)';
        internalMarks.classList.add('marks');
        internalMarks.oninput = function () {
            if (this.value > 40) this.value = 40;
        };
        subjectDiv.appendChild(internalMarks);

        const externalMarks = document.createElement('input');
        externalMarks.type = 'number';
        externalMarks.max = '60';
        externalMarks.placeholder = 'External Marks (min 24)';
        externalMarks.classList.add('marks');
        externalMarks.oninput = function () {
            if (this.value > 60) this.value = 60;
        };
        subjectDiv.appendChild(externalMarks);

        const totalMarks = document.createElement('span');
        totalMarks.classList.add('total-marks');
        totalMarks.textContent = 'Total Marks: 0';
        subjectDiv.appendChild(totalMarks);

        subjectsDiv.appendChild(subjectDiv);
    });

    // Hide download button if subjects are not loaded
    const downloadBtn = document.getElementById('downloadBtn');
    downloadBtn.style.display = 'none';
}

function calculateSGPA() {
    const subjectsDiv = document.getElementById('subjects');
    const subjectDivs = subjectsDiv.getElementsByClassName('subject');
    let totalCredits = 0;
    let totalGradePoints = 0;
    let isQualified = true; // Flag to track qualification

    for (let i = 0; i < subjectDivs.length; i++) {
        const inputs = subjectDivs[i].getElementsByClassName('marks');
        const internalMarks = parseFloat(inputs[0].value) || 0;
        const externalMarks = parseFloat(inputs[1].value) || 0;

        // Check if marks meet the minimum criteria
        if (internalMarks < 16 || externalMarks < 24) {
            isQualified = false;
        }

        const totalMarks = internalMarks + externalMarks;
        const gradePoint = getGradePoint(totalMarks);
        const credits = departments[document.getElementById('department').value][document.getElementById('semester').value][i][1];

        subjectDivs[i].getElementsByClassName('total-marks')[0].textContent = `Total Marks: ${totalMarks}`;

        totalCredits += credits;
        totalGradePoints += gradePoint * credits;
    }

    const sgpa = totalGradePoints / totalCredits;
    document.getElementById('result').textContent = `SGPA: ${sgpa.toFixed(2)}`;

    // Show qualification button based on result
    const qualificationBtn = document.getElementById('qualificationBtn');
    if (isQualified) {
        qualificationBtn.style.display = 'block';
    } else {
        qualificationBtn.style.display = 'none';
    }

    // Show download button after calculating SGPA
    const downloadBtn = document.getElementById('downloadBtn');
    downloadBtn.style.display = 'block';
}

function getGradePoint(totalMarks) {
    if (totalMarks >= 90) return 10;
    if (totalMarks >= 80) return 9;
    if (totalMarks >= 70) return 8;
    if (totalMarks >= 60) return 7;
    if (totalMarks >= 50) return 6;
    if (totalMarks >= 40) return 5;
    return 0;
}

function showQualification() {
    alert('Congratulations! You are qualified for the grade.');
}

function generateReport() {
    const department = document.getElementById('department').value;
    const semester = document.getElementById('semester').value;
    const subjectsDiv = document.getElementById('subjects');
    const subjectDivs = subjectsDiv.getElementsByClassName('subject');
    let report = `<h2>Report for Department: ${department}, Semester: ${semester}</h2>`;
    report += `<h3>College: Gurunanak Dev Engineering College Ludhiana</h3>`;
    report += `<table border="1"><tr><th>Subject</th><th>Credits</th><th>Internal Marks</th><th>External Marks</th><th>Total Marks</th><th>Grade Point</th></tr>`;

    for (let i = 0; i < subjectDivs.length; i++) {
        const subjectName = departments[department][semester][i][0];
        const credits = departments[department][semester][i][1];
        const inputs = subjectDivs[i].getElementsByClassName('marks');
        const internalMarks = parseFloat(inputs[0].value) || 0;
        const externalMarks = parseFloat(inputs[1].value) || 0;
        const totalMarks = internalMarks + externalMarks;
        const gradePoint = getGradePoint(totalMarks);

        report += `<tr><td>${subjectName}</td><td>${credits}</td><td>${internalMarks}</td><td>${externalMarks}</td><td>${totalMarks}</td><td>${gradePoint}</td></tr>`;
    }

    report += `</table>`;
    report += `<p style="margin-top: 20px;">Report generated by: Mr. Karan Singh</p>`;
    document.getElementById('report').innerHTML = report;

    // Create downloadable link
    const blob = new Blob([report], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const link = document.createElement('a');
    link.href = url;
    link.download = `report_${department}_${semester}.html`;
    link.textContent = 'Download Report';
    document.getElementById('report').appendChild(link);
}
